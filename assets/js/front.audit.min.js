(function(e,d,b){var c={action:d._base+"_"+b,wrap:"#wpadminbar ."+d._base+"-"+b+".-wrap",button:"#wpadminbar ."+d._base+"-"+b+".-action a.ab-item",spinner:".geditorial-spinner"};var f={empty:true,watch:function(){e(":input",c.wrap).change(a.debounce(function(){f.store()},1000))},store:function(){var g=e(":input",c.wrap).serialize();var h=e(c.button).find(c.spinner);e.ajax({url:d._url,method:"POST",data:{action:c.action,what:"store",post_id:d[b].post_id,nonce:d[b]._nonce,data:g},beforeSend:function(i){h.addClass("is-active")},success:function(i,k,j){h.removeClass("is-active");if(i.success){e(c.wrap).html(i.data);f.watch()}}})},populate:function(){if(!f.empty){return}var g=e(c.button).find(c.spinner);e.ajax({url:d._url,method:"POST",data:{action:c.action,what:"list",post_id:d[b].post_id,nonce:d[b]._nonce},beforeSend:function(h){g.addClass("is-active")},success:function(h,j,i){g.removeClass("is-active");if(h.success){e(c.wrap).html(h.data);f.empty=false;f.watch()}}})}};var a={debounce:function(h,g){var i=null;return function(){var k=f;var j=arguments;clearTimeout(i);i=setTimeout(function(){h.apply(k,j)},g)}}};e(function(){e(c.button).click(function(g){g.preventDefault();f.populate()});e(document).trigger("gEditorialReady",[b,f])})}(jQuery,gEditorial,"audit"));