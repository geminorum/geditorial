(function(b,c,a){var d={};d.t={text:"#titlewrap input, input#attachment_alt, input#tag-name, #edittag input#name, [data-"+a+"='text']",markdown:"[data-"+a+"='markdown']",html:"textarea#excerpt:not(.wp-editor-area), textarea#attachment_caption, textarea#tag-description, #edittag textarea#description, [data-"+a+"='html']"};d.i={number:"[data-"+a+"='number']"};d.s=b.extend({},{button_virastar:'<span class="dashicons dashicons-text"></span>',button_virastar_title:"Apply Virastar!",qtag_virastar:"Virastar!",qtag_virastar_title:"Apply Virastar!",qtag_swapquotes:"Swap Quotes",qtag_swapquotes_title:"Swap Not-Correct Quotes",qtag_mswordnotes:"Word Footnotes",qtag_mswordnotes_title:"MS Word Footnotes to WordPress [ref]",qtag_download:"Download",qtag_download_title:"Download text as markdown",qtag_nbsp:"nbsp",qtag_nbsp_title:"Non-Breaking SPace"},c[a].strings);d.b='<a href="#" class="do-'+a+'" title="'+d.s.button_virastar_title+'" tabindex="-1">'+d.s.button_virastar+"</a>";d.w='<span class="'+a+'-input-wrap"></span>';d.o=c[a].virastar||{};d.v={text:new Virastar(b.extend({},d.o,{preserve_HTML:false,preserve_URIs:false,preserve_brackets:false,preserve_braces:false})),markdown:new Virastar(b.extend({},d.o,{fix_dashes:false,cleanup_spacing:false,cleanup_begin_and_end:false,skip_markdown_ordered_lists_numbers_conversion:false})),html:new Virastar(b.extend({},d.o,{cleanup_spacing:false}))};d.n={number:function(){var g=b(this);try{g.prop("type","text")}catch(f){}g.change(function(){g.val(d.u.tE(g.val()).replace(/[^\d.-]/g,"").trim())})}};d.u={pF:function(f){var e={};f=f.replace(/<a[^h]*(?=href="[^"]*#_(?:ftn|edn|etc)ref([0-9]+)")[^>]*>\[([0-9]+)\]<\/a>(.*)/g,function(g,j,i,h){e[j]=h.replace(/^\s*./,"").trim();return""});return f.replace(/<a[^h]*(?=href="[^"]*#_(?:ftn|edn|etc)([0-9]+)")[^>]*>(?:<\w+>)*\[([0-9]+)\](?:<\/\w+>)*<\/a>/g,function(g,k,j,i,h){return"[ref]"+e[k].replace(/\r\n|\r|\n/g," ").trim()+"[/ref]"})},sQ:function(e){return e.replace(/(»)(.+?)(«)/g,"«$2»").replace(/(”)(.+?)(“)/g,"“$2”")},tP:function(f){var e="۰".charCodeAt(0);return f.toString().replace(/\d+/g,function(g){return g.split("").map(function(h){return String.fromCharCode(e+parseInt(h))}).join("")})},tE:function(e){return e.toString().replace(/[۱۲۳۴۵۶۷۸۹۰]+/g,function(f){return f.split("").map(function(g){return g.charCodeAt(0)%1776}).join("")})},downloadText:function(e,g){var f=document.createElement("a");f.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(g));f.setAttribute("download",e);f.style.display="none";document.body.appendChild(f);f.click();document.body.removeChild(f)}};d.q={nbsp:function(g,h,f){QTags.insertContent("\n\n&nbsp;\n\n")},virastar:function(h,i,f){var g=i.value.substring(i.selectionStart,i.selectionEnd);if(g!==""){QTags.insertContent(d.v.html.cleanup(g))}else{b(i).val(d.v.html.cleanup(b(i).val()))}},swapquotes:function(g,h,f){b(h).val(d.u.sQ(b(h).val()))},mswordnotes:function(g,h,f){b(h).val(d.u.pF(b(h).val()))},download:function(i,j,g){var f="Untitled";var h="";if(b("#title").length&&b("#title").val()){f=b("#title").val().trim()}else{if(b("#tag-name").length&&b("#tag-name").val()){f=b("#tag-name").val().trim()}else{if(b("#name").length&&b("#name").val()){f=b("#name").val().trim()}else{if(b("#post_ID").length){f="Untitled-"+b("#post_ID").val()}}}}b("input[data-meta-title]").each(function(e){var k=b(this).val();if(k){h=h+b(this).data("meta-title")+": "+k+"\n"}});if(h){h="---\n"+h+"---\n\n"}d.u.downloadText(f+".md",h+"## "+f+"\n"+b(j).val())}};b(function(){for(var h in d.t){b(d.t[h]).each(function(){b(this).data(a,h).addClass("target-"+a).add(b(d.b)).wrapAll('<span class="'+a+"-input-wrap "+a+"-input-"+h+'-wrap"></span>')});b("a.do-"+a).on("click",function(k){k.preventDefault();var i=b(this).closest("."+a+"-input-wrap").find(".target-"+a);i.val(d.v[i.data(a)].cleanup(i.val()))});b(".target-"+a).on("paste",function(){var i=this;setTimeout(function(){var e=b(i);e.val(d.v[e.data(a)].cleanup(e.val()))},100)})}for(var g in d.i){b(d.i[g]).each(function(){d.n[g].call(this)})}if(typeof QTags!=="undefined"){for(var f in d.q){QTags.addButton(f,d.s["qtag_"+f],d.q[f],"","",d.s["qtag_"+f+"_title"])}}try{document.post.title.focus()}catch(j){}b(document).trigger("gEditorialReady",[a,d])})}(jQuery,gEditorial,"ortho"));