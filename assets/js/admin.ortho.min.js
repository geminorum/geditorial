((c,t,p)=>{if(void 0!==t){let a=c.extend({},{virastar_on_paste:!1},t[p].settings),e={text:"#titlewrap input, input#attachment_alt, input#tag-name, #edittag input#name, [data-ortho='text']",markdown:"[data-ortho='markdown']",html:"textarea#excerpt:not(.wp-editor-area), textarea#attachment_caption, textarea#tag-description, #edittag textarea#description, [data-ortho='html']"},r={number:"[data-ortho='number']",alphabet:"[data-ortho='alphabet']",slug:"[data-ortho='slug']",hook:"[data-ortho='hook']",identity:"[data-ortho='identity']",phone:"[data-ortho='phone']",isbn:"[data-ortho='isbn']",vin:"[data-ortho='vin']",plate:"[data-ortho='plate']",iban:"[data-ortho='iban']",bankcard:"[data-ortho='bankcard']",year:"[data-ortho='year']",date:"[data-ortho='date']",datetime:"[data-ortho='datetime']",distance:"[data-ortho='distance']",duration:"[data-ortho='duration']",area:"[data-ortho='area']"},o=c.extend({},{button_virastar:'<span class="dashicons dashicons-text"></span>',button_virastar_title:"Apply Virastar!",qtag_virastar:"Virastar!",qtag_virastar_title:"Apply Virastar!",qtag_swapquotes:"Swap Quotes",qtag_swapquotes_title:"Swap Not-Correct Quotes",qtag_mswordnotes:"Word Footnotes",qtag_mswordnotes_title:"MS Word Footnotes to WordPress [ref]",qtag_download:"Download",qtag_download_title:"Download text as markdown",qtag_nbsp:"nbsp",qtag_nbsp_title:"Non-Breaking SPace"},t[p].strings),n='<a href="#" class="do-ortho" title="'+o.button_virastar_title+'" tabindex="-1">'+o.button_virastar+"</a>";t=t[p].virastar||{};let i={text:new Virastar(c.extend({},t,{preserve_HTML:!1,preserve_URIs:!1,preserve_frontmatter:!1})),markdown:new Virastar(c.extend({},t,{preserve_frontmatter:!1,skip_markdown_ordered_lists_numbers_conversion:!0})),html:new Virastar(c.extend({},t,{preserve_frontmatter:!1,preserve_brackets:!0,preserve_braces:!0}))},l={number:function(){let t=c(this);try{t.prop("type","text")}catch(t){}t.on("change",function(){t.val(u(h(t.val())).replace(/[^\d.-]/g,"").trim())})},alphabet:function(){let t=c(this);try{t.prop("type","text")}catch(t){}t.on("change",function(){t.val(t.val().replace(/[^a-zA-Z]/gi,"").trim().toUpperCase())})},slug:function(){let t=c(this);try{t.prop("type","text")}catch(t){}t.on("change",function(){t.val(u(h(t.val().trim().replace(/[\s-_]+/gi,"-"))).replace(/[^a-zA-Z0-9-]/gi,"").trim().toLowerCase())})},hook:function(){let t=c(this);try{t.prop("type","text")}catch(t){}t.on("change",function(){t.val(u(h(t.val().trim().replace(/[\s-]+/gi,"_"))).replace(/[^a-zA-Z0-9_]/gi,"").trim().toLowerCase())})},identity:function(){let a=c(this);try{a.prop("type","text")}catch(t){}a.on("change",function(){var t=u(h(a.val())).replace(/[^\d.-]/g,"").trim();a.val(t),g(t)?a.addClass("ortho-is-valid").removeClass("ortho-not-valid"):a.addClass("ortho-not-valid").removeClass("ortho-is-valid")})},phone:function(){let e=c(this);try{e.prop("type","text")}catch(t){}e.on("change",function(){t=u(h(e.val())),a="tel:";var t,a=(t.startsWith(a)?t.slice(a.length):t).replace(/[^\d+]/g,"").trim();e.val(a),(t=>void 0!==t&&t&&/^[+]?(?=(?:[^\dx]*\d){7})(?:\(\d+(?:\.\d+)?\)|\d+(?:\.\d+)?)(?:[ -]?(?:\(\d+(?:\.\d+)?\)|\d+(?:\.\d+)?))*(?:[ ]?(?:x|ext)\.?[ ]?\d{1,5})?$/.test(t))(a)?e.addClass("ortho-is-valid").removeClass("ortho-not-valid"):e.addClass("ortho-not-valid").removeClass("ortho-is-valid")})},isbn:function(){let a=c(this);try{a.prop("type","text")}catch(t){}a.on("change",function(){var t=u(h(a.val())).replace(/[^\d.-]/g,"").trim();a.val(t),console.log(v(t)),f(t)?a.addClass("ortho-is-valid").removeClass("ortho-not-valid"):f(v(t))?(a.val(v(t)),a.addClass("ortho-is-valid").removeClass("ortho-not-valid")):a.addClass("ortho-not-valid").removeClass("ortho-is-valid")})},vin:function(){let a=c(this);try{a.prop("type","text")}catch(t){}a.on("change",function(){var t=u(h(a.val())).toUpperCase().replace(/[^A-Z\d.-]/g,"").trim();a.val(t),((t=t)&&17===t.length&&/[a-zA-Z0-9]{9}[a-zA-Z0-9-]{2}[0-9]{6}/.test(t)?1:void 0)?a.addClass("ortho-is-valid").removeClass("ortho-not-valid"):a.addClass("ortho-not-valid").removeClass("ortho-is-valid")})},plate:function(){let a=c(this);try{a.prop("type","text")}catch(t){}a.on("change",function(){var t=u(h(a.val())).toUpperCase().replace(/[^A-Z\d.-]/g,"").trim();a.val(t),t?a.addClass("ortho-is-valid").removeClass("ortho-not-valid"):a.addClass("ortho-not-valid").removeClass("ortho-is-valid")})},iban:function(){let a=c(this);try{a.prop("type","text")}catch(t){}a.on("change",function(){var t=u(h(a.val())).replace(/IR[^\d.-]/g,"").trim();a.val(t),m(t)?a.addClass("ortho-is-valid").removeClass("ortho-not-valid"):a.addClass("ortho-not-valid").removeClass("ortho-is-valid")})},bankcard:function(){let a=c(this);try{a.prop("type","text")}catch(t){}a.on("change",function(){var t=u(h(a.val())).replace(/[^\d.-]/g,"").trim();a.val(t),(e=>{if(void 0!==e&&e){var r,t=e.trim().length;if(!(t<16||0===parseInt(e.substr(1,10),10)||0===parseInt(e.substr(10,6),10))){let a=0;for(let t=0;t<16;t++)r=t%2==0?2:1,r=parseInt(e.substr(t,1),10)*r,a+=9<r?r-9:r;return a%10==0}}})(t)?a.addClass("ortho-is-valid").removeClass("ortho-not-valid"):a.addClass("ortho-not-valid").removeClass("ortho-is-valid")})},year:function(){let t=c(this);try{t.prop("type","text")}catch(t){}t.on("change",function(){t.val(u(h(t.val())).replace(/[^\d.\-/\\]/g,"").trim())})},date:function(){let t=c(this);try{t.prop("type","text")}catch(t){}t.on("change",function(){t.val(u(h(t.val())).replace(/[^\d.\-/\\]/g,"").trim())})},datetime:function(){let t=c(this);try{t.prop("type","text")}catch(t){}t.on("change",function(){t.val(u(h(t.val())).replace(/[^\d.\-/\\: ]/g,"").trim())})},distance:function(){let t=c(this);try{t.prop("type","text")}catch(t){}t.on("change",function(){t.val(u(h(t.val())).replace(/[^\d.\-/\\ ]/g,"").trim())})},duration:function(){let t=c(this);try{t.prop("type","text")}catch(t){}t.on("change",function(){t.val(u(h(t.val())).replace(/[^\d.\-/\\: ]/g,"").trim())})},area:function(){let t=c(this);try{t.prop("type","text")}catch(t){}t.on("change",function(){t.val(u(h(t.val())).replace(/[^\d.\-/\\ ]/g,"").trim())})}},s={nbsp:"",virastar:"",swapquotes:"content",mswordnotes:"content",download:"content"},d={nbsp:function(t,a,e){QTags.insertContent("\n\n&nbsp;\n\n")},virastar:function(t,a,e){var r=a.value.substring(a.selectionStart,a.selectionEnd);""!==r?QTags.insertContent(i.html.cleanup(r)):c(a).val(i.html.cleanup(c(a).val()))},swapquotes:function(t,a,e){c(a).val(c(a).val().replace(/(»)(.+?)(«)/g,"«$2»").replace(/(”)(.+?)(“)/g,"“$2”"))},mswordnotes:function(t,a,e){c(a).val((t=>{let n={};return(t=t.replace(/<a[^h]*(?=href="[^"]*#_(?:ftn|edn|etc)ref([0-9]+)")[^>]*>\[([0-9]+)\]<\/a>(.*)/g,function(t,a,e,r){return n[a]=r.replace(/^\s*|\s*$/gm,"").trim(),""})).replace(/<a[^h]*(?=href="[^"]*#_(?:ftn|edn|etc)([0-9]+)")[^>]*>(?:<\w+>)*\[([0-9]+)\](?:<\/\w+>)*<\/a>/g,function(t,a,e,r,o){return"[ref]"+n[a].replace(/\r\n|\r|\n/g," ").trim()+"[/ref]"})})(c(a).val()))},download:function(t,a,e){let r="Untitled",o="";var n,i;c("#title").length&&c("#title").val()?r=c("#title").val().trim():c("#tag-name").length&&c("#tag-name").val()?r=c("#tag-name").val().trim():c("#name").length&&c("#name").val()?r=c("#name").val().trim():c("#post_ID").length&&(r="Untitled-"+c("#post_ID").val()),c("input[data-meta-title]").each(function(t){var a=c(this).val();a&&(o=o+c(this).data("meta-title")+": "+a+"\n")}),o=o&&"---\n"+o+"---\n\n",n=r+".md",a=o+"## "+r+"\n"+c(a).val(),(i=document.createElement("a")).setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(a)),i.setAttribute("download",n),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}};function h(t){return t.replace(/[\u0640—–]+/g,"-")}function v(t){return t.split("-").reverse().join("-")}function u(t){return t.toString().replace(/[۱۲۳۴۵۶۷۸۹۰]+/g,function(t){return t.split("").map(function(t){return t.charCodeAt(0)%1776}).join("")})}function g(e){if(void 0!==e&&e&&("string"==typeof(t=e)&&!Number.isNaN(t)&&10===e.trim().length)){var t=parseInt(e[9],10);let a=0;for(let t=0;t<9;t+=1)a+=parseInt(e[t],10)*(10-t);return(a%=11)<2&&t===a||2<=a&&t+a===11}}function f(r){if(void 0!==r&&r)if(/^(?:ISBN(?:-1[03])?:? )?(?=[0-9X]{10}$|(?=(?:[0-9]+[- ]){3})[- 0-9X]{13}$|97[89][0-9]{10}$|(?=(?:[0-9]+[- ]){4})[- 0-9]{17}$)(?:97[89][- ]?)?[0-9]{1,5}[- ]?[0-9]+[- ]?[0-9]+[- ]?[0-9X]$/.test(r)){var o=r.replace(/[- ]|^ISBN(?:-1[03])?:?/g,"").split(""),r=o.pop();let t=0,a,e;if(9===o.length){for(o.reverse(),e=0;e<o.length;e++)t+=(e+2)*parseInt(o[e],10);10===(a=11-t%11)?a="X":11===a&&(a="0")}else{for(e=0;e<o.length;e++)t+=(e%2*2+1)*parseInt(o[e],10);10===(a=10-t%10)&&(a="0")}return a===parseInt(r)}}function m(t){var a,e,r;if(void 0!==t&&t&&(26===t.trim().length&&/IR[0-9]{24}/.test(t)))return a=t.substr(4),e=t.charCodeAt(0)-65+10,r=t.charCodeAt(1)-65+10,1===(t=>{let a=t;for(var e;2<a.length;)e=a.slice(0,9),a=parseInt(e,10)%97+a.slice(e.length);return parseInt(a,10)%97})(a+=e.toString()+r.toString()+t.substr(2,2))}c(function(){for(let t in e)c(e[t]).each(function(){c(this).data(p,t).addClass("target-"+p).add(c(n)).wrapAll('<span class="ortho-input-wrap ortho-input-'+t+'-wrap"></span>')}),c("a.do-"+p).on("click",function(t){t.preventDefault();t=c(this).closest(".ortho-input-wrap").find(".target-"+p);t.val(i[t.data(p)].cleanup(t.val()))}),a.virastar_on_paste&&c(".target-"+p).on("paste",function(){let a=this;setTimeout(function(){var t=c(a);t.val(i[t.data(p)].cleanup(t.val()))},100)});for(let t in r)c(r[t]).each(function(){l[t].call(this)});if("undefined"!=typeof QTags)for(var t in s)QTags.addButton(t,o["qtag_"+t],d[t],"","",o["qtag_"+t+"_title"],0,s[t]);try{document.post.title.focus()}catch(t){}c(document).trigger("gEditorialReady",[p,null])})}})(jQuery,gEditorial,"ortho");