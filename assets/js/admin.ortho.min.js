(function(b,c,a){var e={};var d={settings:b.extend({},{virastar_on_paste:false},c[a].settings),types:{text:"#titlewrap input, input#attachment_alt, input#tag-name, #edittag input#name, [data-"+a+"='text']",markdown:"[data-"+a+"='markdown']",html:"textarea#excerpt:not(.wp-editor-area), textarea#attachment_caption, textarea#tag-description, #edittag textarea#description, [data-"+a+"='html']"},inputs:{number:"[data-"+a+"='number']"}};e.s=b.extend({},{button_virastar:'<span class="dashicons dashicons-text"></span>',button_virastar_title:"Apply Virastar!",qtag_virastar:"Virastar!",qtag_virastar_title:"Apply Virastar!",qtag_swapquotes:"Swap Quotes",qtag_swapquotes_title:"Swap Not-Correct Quotes",qtag_mswordnotes:"Word Footnotes",qtag_mswordnotes_title:"MS Word Footnotes to WordPress [ref]",qtag_download:"Download",qtag_download_title:"Download text as markdown",qtag_nbsp:"nbsp",qtag_nbsp_title:"Non-Breaking SPace"},c[a].strings);e.b='<a href="#" class="do-'+a+'" title="'+e.s.button_virastar_title+'" tabindex="-1">'+e.s.button_virastar+"</a>";e.w='<span class="'+a+'-input-wrap"></span>';e.o=c[a].virastar||{};e.v={text:new Virastar(b.extend({},e.o,{preserve_HTML:false,preserve_URIs:false,preserve_brackets:false,preserve_braces:false})),markdown:new Virastar(b.extend({},e.o,{fix_dashes:false,cleanup_spacing:false,cleanup_begin_and_end:false,skip_markdown_ordered_lists_numbers_conversion:false})),html:new Virastar(b.extend({},e.o,{cleanup_spacing:false}))};e.n={number:function(){var g=b(this);try{g.prop("type","text")}catch(f){}g.change(function(){g.val(e.u.tE(g.val()).replace(/[^\d.-]/g,"").trim())})}};e.u={pF:function(g){var f={};g=g.replace(/<a[^h]*(?=href="[^"]*#_(?:ftn|edn|etc)ref([0-9]+)")[^>]*>\[([0-9]+)\]<\/a>(.*)/g,function(h,k,j,i){f[k]=i.replace(/^\s*./,"").trim();return""});return g.replace(/<a[^h]*(?=href="[^"]*#_(?:ftn|edn|etc)([0-9]+)")[^>]*>(?:<\w+>)*\[([0-9]+)\](?:<\/\w+>)*<\/a>/g,function(h,l,k,j,i){return"[ref]"+f[l].replace(/\r\n|\r|\n/g," ").trim()+"[/ref]"})},sQ:function(f){return f.replace(/(»)(.+?)(«)/g,"«$2»").replace(/(”)(.+?)(“)/g,"“$2”")},tP:function(g){var f="۰".charCodeAt(0);return g.toString().replace(/\d+/g,function(h){return h.split("").map(function(i){return String.fromCharCode(f+parseInt(i))}).join("")})},tE:function(f){return f.toString().replace(/[۱۲۳۴۵۶۷۸۹۰]+/g,function(g){return g.split("").map(function(h){return h.charCodeAt(0)%1776}).join("")})},downloadText:function(f,h){var g=document.createElement("a");g.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(h));g.setAttribute("download",f);g.style.display="none";document.body.appendChild(g);g.click();document.body.removeChild(g)}};e.q={nbsp:"",virastar:"",swapquotes:"content",mswordnotes:"content",download:"content"};e.qu={nbsp:function(g,h,f){QTags.insertContent("\n\n&nbsp;\n\n")},virastar:function(h,i,f){var g=i.value.substring(i.selectionStart,i.selectionEnd);if(g!==""){QTags.insertContent(e.v.html.cleanup(g))}else{b(i).val(e.v.html.cleanup(b(i).val()))}},swapquotes:function(g,h,f){b(h).val(e.u.sQ(b(h).val()))},mswordnotes:function(g,h,f){b(h).val(e.u.pF(b(h).val()))},download:function(i,j,g){var f="Untitled";var h="";if(b("#title").length&&b("#title").val()){f=b("#title").val().trim()}else{if(b("#tag-name").length&&b("#tag-name").val()){f=b("#tag-name").val().trim()}else{if(b("#name").length&&b("#name").val()){f=b("#name").val().trim()}else{if(b("#post_ID").length){f="Untitled-"+b("#post_ID").val()}}}}b("input[data-meta-title]").each(function(k){var l=b(this).val();if(l){h=h+b(this).data("meta-title")+": "+l+"\n"}});if(h){h="---\n"+h+"---\n\n"}e.u.downloadText(f+".md",h+"## "+f+"\n"+b(j).val())}};b(function(){for(var h in d.types){b(d.types[h]).each(function(){b(this).data(a,h).addClass("target-"+a).add(b(e.b)).wrapAll('<span class="'+a+"-input-wrap "+a+"-input-"+h+'-wrap"></span>')});b("a.do-"+a).on("click",function(k){k.preventDefault();var i=b(this).closest("."+a+"-input-wrap").find(".target-"+a);i.val(e.v[i.data(a)].cleanup(i.val()))});if(d.settings.virastar_on_paste){b(".target-"+a).on("paste",function(){var i=this;setTimeout(function(){var k=b(i);k.val(e.v[k.data(a)].cleanup(k.val()))},100)})}}for(var g in d.inputs){b(d.inputs[g]).each(function(){e.n[g].call(this)})}if(typeof QTags!=="undefined"){for(var f in e.q){QTags.addButton(f,e.s["qtag_"+f],e.qu[f],"","",e.s["qtag_"+f+"_title"],0,e.q[f])}}try{document.post.title.focus()}catch(j){}b(document).trigger("gEditorialReady",[a,e])})}(jQuery,gEditorial,"ortho"));