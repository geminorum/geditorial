!function(i,n,e){const d={form:"div#"+n._base+"-newpost form.-form",wrap:"div.-wrap.geditorial-wrap.-newpost-layout",recent:"div.-recents ul li a.-row-link-custom",save:"a.button.-save-draft"},t={request:null,strings:i.extend({},{noparent:"This page has no parent window!",notarget:"Cannot handle the target window!",closeme:"New post has been saved you may close this!"},n[e].strings||{}),init:function(){const t=this;self===top?i(".-message",d.wrap).html(t.strings.noparent).addClass("-error"):(i(d.recent,d.wrap).on("click",function(e){e.preventDefault(),t.handleRecent(i(this).data("post"),i(this).data("type"))}),i(d.save,d.wrap).removeClass("disabled").on("click",function(e){e.preventDefault(),t.doSaveDraft(i(this).data("endpoint"),i(this).data("target"))}),i(d.form).submit(function(e){e.preventDefault(),t.request&&"pending"===t.request.state()||i(d.save,d.wrap).trigger("click")}))},handleRecent:function(e,t){const a=i("select."+n._base+'-paired-to-post-dropdown[data-type="'+t+'"]',window.parent.document);a.val(e).change(),self.parent.tb_remove()},handlePaired:function(e){const t=i("select."+n._base+'-paired-to-post-dropdown[data-type="'+e.type+'"]',window.parent.document);t.removeClass("hidden").append('<option value="'+e.id+'">'+e.title.rendered+"</option>").val(e.id).change(),window.parent.jQuery(t).trigger("chosen:updated"),self.parent.tb_remove()},getFormData:function(e){return i(e).serializeArray().reduce(function(e,t){var a=/^(\w+)\[(\w+)\]$/.exec(t.name);if(a)return void 0===e[a[1]]&&(e[a[1]]={}),e[a[1]][a[2]]=t.value,e;a=t.name.replace("[]","");return void 0!==e[a]?Array.isArray(e[a])?e[a].push(t.value):e[a]=[e[a],t.value]:e[a]=t.value,e},{})},doSaveDraft:function(e,t){const a=this;var n=a.getFormData(d.form);const r=i(d.save,d.wrap),s=i(".-message",d.wrap),o=i(".-loading",d.wrap);console.log(n),a.request=wp.apiRequest({url:e,data:n,type:"POST",dataType:"json",beforeSend:function(){s.html("").removeClass("-error"),o.addClass("is-active"),r.addClass("disabled")}}).done(function(e){"paired"===t?a.handlePaired(e):"none"===t?s.html(a.strings.closeme).addClass("-success"):s.html(a.strings.notarget).addClass("-error"),console.log(e)}).fail(function(e){s.html(e.responseJSON.message).addClass("-error"),console.log(e.responseJSON)}).always(function(){o.removeClass("is-active"),r.removeClass("disabled")})}};i(function(){t.init(),i(document).trigger("gEditorialReady",[e,t])})}(jQuery,gEditorial,"_newpost");