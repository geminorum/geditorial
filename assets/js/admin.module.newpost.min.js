!function(i,t,e){const d={form:"div#"+t._base+"-newpost form.-form",wrap:"div.-wrap.geditorial-wrap.-newpost-layout",recent:"div.-recents ul li a.-row-link-custom",save:"a.button.-save-draft"},a={request:null,strings:i.extend({},{noparent:"This page has no parent window!",notarget:"Cannot handle the target window!",closeme:"New post has been saved you may close this!"},t[e].strings||{}),init:function(){const a=this;self===top?i(".-message",d.wrap).html(a.strings.noparent).addClass("-error"):(i(d.recent,d.wrap).on("click",function(e){e.preventDefault(),a.handleRecent(i(this).data("post"),i(this).data("type"))}),i(d.save,d.wrap).removeClass("disabled").on("click",function(e){e.preventDefault(),a.doSaveDraft(i(this).data("endpoint"),i(this).data("target"))}),i(d.form).submit(function(e){e.preventDefault(),a.request&&"pending"===a.request.state()||i(d.save,d.wrap).trigger("click")}))},handleRecent:function(e,a){i("select."+t._base+'-paired-to-post-dropdown[data-type="'+a+'"]',window.parent.document).val(e).change(),self.parent.tb_remove()},handlePaired:function(e){var a=i("select."+t._base+'-paired-to-post-dropdown[data-type="'+e.type+'"]',window.parent.document);a.removeClass("hidden").append('<option value="'+e.id+'">'+e.title.rendered+"</option>").val(e.id).change(),window.parent.jQuery(a).trigger("chosen:updated"),self.parent.tb_remove()},getFormData:function(e){return i(e).serializeArray().reduce(function(e,a){var t=/^(\w+)\[(\w+)\]$/.exec(a.name);return t?(void 0===e[t[1]]&&(e[t[1]]={}),e[t[1]][t[2]]=a.value):void 0!==e[t=a.name.replace("[]","")]?Array.isArray(e[t])?e[t].push(a.value):e[t]=[e[t],a.value]:e[t]=a.value,e},{})},doSaveDraft:function(e,a){const t=this;var n=t.getFormData(d.form);const r=i(d.save,d.wrap),s=i(".-message",d.wrap),o=i(".-loading",d.wrap);console.log(n),t.request=wp.apiRequest({url:e,data:n,type:"POST",dataType:"json",beforeSend:function(){s.html("").removeClass("-error"),o.addClass("is-active"),r.addClass("disabled")}}).done(function(e){"paired"===a?t.handlePaired(e):"none"===a?s.html(t.strings.closeme).addClass("-success"):s.html(t.strings.notarget).addClass("-error"),console.log(e)}).fail(function(e){s.html(e.responseJSON.message).addClass("-error"),console.log(e.responseJSON)}).always(function(){o.removeClass("is-active"),r.removeClass("disabled")})}};i(function(){a.init(),i(document).trigger("gEditorialReady",[e,a])})}(jQuery,gEditorial,"_newpost");