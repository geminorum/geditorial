((s,i,e,t)=>{let r=1024e3,a={},c={},l={action:[i._base,e].join("_"),classs:[i._base,e].join("-"),input:"#"+[i._base,e,t,"input"].join("-"),name:"#"+[i._base,e,t,"name"].join("-"),submit:"#"+[i._base,e,t,"submit"].join("-"),progress:"#"+[i._base,e,t,"progress"].join("-")},u={check:function(){let t=s(l.submit),a=s(l.progress).prev(".spinner");s.ajax({url:i._url,type:"POST",dataType:"json",cache:!1,data:{action:l.action,what:"upload_check",file:c.name,mime:c.type,nonce:t.data("nonce")},beforeSend:function(e){a.addClass("is-active")},error:function(e,t,a){console.log(e,t,a)},success:function(e){a.removeClass("is-active"),e.success?u.upload(0):(p.io(l.progress,e.data),t.prop("disabled",!0),console.log(e))}})},upload:function(o){let n=o+r+1;var e=c.slice(o,n);a.onloadend=function(e){if(e.target.readyState===FileReader.DONE){let a=s(l.submit);s.ajax({url:i._url,type:"POST",dataType:"json",cache:!1,data:{action:l.action,what:"upload_chaunk",file_data:e.target.result,file:c.name,mime:c.type,chunk:o,nonce:a.data("nonce")},error:function(e,t,a){console.log(e,t,a)},success:function(e){if(e.success){var t=o+r;let e=Math.floor(t/c.size*100);n<c.size?("fa_IR"===a.data("locale")&&(e=p.tP(e)),p.io(l.progress,p.sp(a.data("progress"),e)),u.upload(n)):(s(l.name).html("").hide(),s(l.submit).prop("disabled",!0),p.io(l.progress,a.data("complete")),u.complete(c.name))}else p.io(l.progress,e.data),console.log(e)}})}},a.readAsDataURL(e)},complete:function(e){var t=s(l.submit);let a=s(l.progress).prev(".spinner");s.ajax({url:i._url,type:"GET",data:{action:l.action,what:"upload_complete",file:e,nonce:t.data("nonce")},beforeSend:function(e){a.addClass("is-active")},error:function(e,t,a){console.log(e,t,a)},success:function(e){a.removeClass("is-active"),e.success?p.io(l.progress,e.data):(p.io(l.progress,e.data),console.log(e))}})}},p={baseName:function(e){return e.split(/[\\/]/).pop()},formatBytes:function(e,t){var a;return 0===e?"0 Bytes":(a=Math.floor(Math.log(e)/Math.log(1024)),parseFloat((e/Math.pow(1024,a)).toFixed(t||2))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][a])},sp:function(e){let t=Array.prototype.slice.call(arguments,1),a=0;return e.replace(/%s/g,function(){return t[a++]})},tP:function(e){let t="Û°".charCodeAt(0);return e.toString().replace(/\d+/g,function(e){return e.split("").map(function(e){return String.fromCharCode(t+parseInt(e))}).join("")})},io:function(e,t){s(e).fadeOut("fast",function(){s(this).html(t).fadeIn()})}};s(function(){s(l.input).on("change",function(){var e=s(this).val();""!==e?(s(l.name).html(p.baseName(e)+" ("+p.formatBytes(this.files[0].size)+")").show(),s(l.submit).prop("disabled",!1)):(s(l.name).html("").hide(),s(l.submit).prop("disabled",!0))}),s(l.submit).on("click",function(e){e.preventDefault(),s(this).prop("disabled",!0),a=new FileReader,c=document.querySelector(l.input).files[0],u.check()}),s(document).trigger("gEditorial:Module:Loaded",[e,u])})})(jQuery,gEditorial,"uploader","largefile");