/*!
* Virastar - v0.13.0 - 2017-11-14
* https://github.com/juvee/virastar
* Licensed: MIT
*/
(function(a,c,b){if(typeof module!=="undefined"){module.exports=b()}else{if(typeof define==="function"&&typeof define.amd==="object"){define(b)}else{if(typeof window!=="undefined"){window[a]=b()}else{c[a]=b()}}}}("Virastar",this,function(){function a(c,b){if(!(this instanceof a)){return new a(c,b)}c=c||{};if(typeof c==="object"){this.opts=this.parseOptions(c)}else{if(typeof c==="string"){this.opts=this.parseOptions(b||{});return this.cleanup(c)}}return this}a.prototype.parseOptions=function(b){var d={normalize_eol:true,fix_dashes:true,fix_three_dots:true,fix_english_quotes_pairs:true,fix_english_quotes:true,fix_hamzeh:true,cleanup_rlm:true,cleanup_zwnj:true,fix_spacing_for_braces_and_quotes:true,fix_numbersArabic:true,fix_numbersEnglish:true,fix_misc_non_persian_chars:true,fix_question_mark:true,skip_markdown_ordered_lists_numbers_conversion:true,fix_perfix_spacing:true,fix_suffix_spacing:true,aggresive:true,kashidas_as_parenthetic:true,cleanup_kashidas:true,cleanup_extra_marks:true,cleanup_spacing:true,cleanup_begin_and_end:true,preserve_HTML:true,preserve_URIs:true,preserve_brackets:true,preserve_braces:true};for(var c in d){if(b.hasOwnProperty(c)){d[c]=b[c]}}return d};a.prototype.cleanup=function(i,m){var b=m?this.parseOptions(m):this.opts;var k="۱۲۳۴۵۶۷۸۹۰";var g="١٢٣٤٥٦٧٨٩٠";var d="1234567890";var l=function(r,q,o){var s=q.split("");var n=o.split("");for(var p in s){r=r.replace(new RegExp(s[p],"g"),n[p])}return r};if(b.preserve_HTML){var e=[];i=i.replace(/(<[^<>]+>)/g,function(n){e.push(n);return"__HTML__PRESERVER__"})}if(b.preserve_URIs){var h=[];var f=new RegExp("([A-Za-z][A-Za-z0-9+\\-.]*):(?:(//)(?:((?:[A-Za-z0-9\\-._~!$&'()*+,;=:]|%[0-9A-Fa-f]{2})*)@)?((?:\\[(?:(?:(?:(?:[0-9A-Fa-f]{1,4}:){6}|::(?:[0-9A-Fa-f]{1,4}:){5}|(?:[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){4}|(?:(?:[0-9A-Fa-f]{1,4}:){0,1}[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){3}|(?:(?:[0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){2}|(?:(?:[0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}:|(?:(?:[0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})?::)(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}|(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))|(?:(?:[0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}|(?:(?:[0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})?::)|[Vv][0-9A-Fa-f]+\\.[A-Za-z0-9\\-._~!$&'()*+,;=:]+)\\]|(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|(?:[A-Za-z0-9\\-._~!$&'()*+,;=]|%[0-9A-Fa-f]{2})*))(?::([0-9]*))?((?:/(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})*)*)|/((?:(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})+(?:/(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})*)*)?)|((?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})+(?:/(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})*)*)|)(?:\\?((?:[A-Za-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9A-Fa-f]{2})*))?(?:\\#((?:[A-Za-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9A-Fa-f]{2})*))?","g");i=i.replace(f,function(n){h.push(n);return"__URI__PRESERVER__"})}if(b.preserve_brackets){var j=[];i=i.replace(/(\[.*?\])/g,function(n){j.push(n);return"__BRACKETS__PRESERVER__"})}if(b.preserve_braces){var c=[];i=i.replace(/(\{.*?\})/g,function(n){c.push(n);return"__BRACES__PRESERVER__"})}if(b.normalize_eol){i=i.replace(/(\r?\n)|(\r\n?)/g,"\n")}if(b.fix_dashes){i=i.replace(/-{3}/g,"—");i=i.replace(/-{2}/g,"–")}if(b.fix_three_dots){i=i.replace(/\s*\.{3,}/g,"…")}if(b.fix_english_quotes_pairs){i=i.replace(/(“)(.+?)(”)/g,"«$2»")}if(b.fix_english_quotes){i=i.replace(/(["'`]+)(.+?)(\1)/g,"«$2»")}if(b.fix_hamzeh){i=i.replace(/(\S)(ه[\s\u200C]+[یي])(\s)/g,"$1\u0647\u0654$3")}if(b.cleanup_rlm){i=i.replace(/([^a-zA-Z\-_])(\u200F)/g,"$1\u200c")}if(b.cleanup_zwnj){i=i.replace(/\u200C{2,}/g,"\u200c");i=i.replace(/([۰-۹0-9إأةؤورزژاآدذ،؛,:«»\\/@#$٪×*()ـ\-=|])\u200c/g,"$1");i=i.replace(/\u200c([\w])/g,"$1");i=i.replace(/([\w])\u200c/g,"$1");i=i.replace(/\u200c([\n\s[].،«»:()؛؟?;$!@-=+\\])/g,"$1");i=i.replace(/([\n\s[.،«»:()؛؟?;$!@\-=+\\])\u200c/g,"$1");i=i.replace(/\s+\u200C|\u200C\s+/g," ")}if(b.fix_numbersArabic){i=l(i,g,k)}i=i.replace(/(^|\s+)(\S+)(?=($|\s+))/g,function(n,o,p,q){if(p.match(/[a-zA-Z\-_]{2,}/g)){return n}if(p.match(/&#\d+;/g)){return n}if(b.skip_markdown_ordered_lists_numbers_conversion&&(n+q).match(/(?:(?:\r?\n)|(?:\r\n?)|(?:^|\n))\d+\.\s/)){return n}if(b.fix_numbersEnglish){n=l(n,d,k)}if(b.fix_misc_non_persian_chars){n=l(n,",;كي%","،؛کی٪")}if(b.fix_question_mark){n=n.replace(/(\?)/g,"\u061F")}return n});if(b.fix_perfix_spacing){i=i.replace(/((\s+|^)ن?می)\u0020/g,"$1\u200C")}if(b.fix_suffix_spacing){i=i.replace(/\u0020(تر(ی(ن)?)?|ها(ی)?\s+)/g,"\u200C$1")}if(b.aggresive){if(b.cleanup_extra_marks){i=i.replace(/(!){2,}/g,"$1");i=i.replace(/(\u061F){2,}/g,"$1")}if(b.kashidas_as_parenthetic){i=i.replace(/(\s)\u0640+/g,"$1–");i=i.replace(/\u0640+(\s)/g,"–$1")}if(b.cleanup_kashidas){i=i.replace(/(\S)\u0640+(\S)/g,"$1$2")}}if(b.fix_spacing_for_braces_and_quotes){i=i.replace(/[ \t\u200C]*(\()\s*([^)]+?)\s*?(\))[ \t\u200C]*/g," $1$2$3 ");i=i.replace(/[ \t\u200C]*(\[)\s*([^\]]+?)\s*?(\])[ \t\u200C]*/g," $1$2$3 ");i=i.replace(/[ \t\u200C]*(\{)\s*([^}]+?)\s*?(\})[ \t\u200C]*/g," $1$2$3 ");i=i.replace(/[ \t\u200C]*(“)\s*([^”]+?)\s*?(”)[ \t\u200C]*/g," $1$2$3 ");i=i.replace(/[ \t\u200C]*(«)\s*([^»]+?)\s*?(»)[ \t\u200C]*/g," $1$2$3 ");i=i.replace(/[ \t\u200C]*([:;,؛،.؟!]{1})[ \t\u200C]*/g,"$1 ");i=i.replace(/([۰-۹]+):\s+([۰-۹]+)/g,"$1:$2");i=i.replace(/(\u061F|!)\s(\u061F|!)/g,"$1$2");i=i.replace(/(\()\s*([^)]+?)\s*?(\))/g,"$1$2$3");i=i.replace(/(\[)\s*([^\]]+?)\s*?(\])/g,"$1$2$3");i=i.replace(/(\{)\s*([^}]+?)\s*?(\})/g,"$1$2$3");i=i.replace(/(“)\s*([^”]+?)\s*?(”)/g,"$1$2$3");i=i.replace(/(«)\s*([^»]+?)\s*?(»)/g,"$1$2$3")}if(b.cleanup_spacing){i=i.replace(/[ ]+/g," ");i=i.replace(/([\n]+)[ \t\u200C]*/g,"$1")}if(b.cleanup_begin_and_end){i=i.replace(/^[\s\u200c]+|[\s\u200c]+$/g,"")}if(b.preserve_braces){i=i.replace(/__BRACES__PRESERVER__/g,function(){return c.shift()})}if(b.preserve_brackets){i=i.replace(/__BRACKETS__PRESERVER__/g,function(){return j.shift()})}if(b.preserve_URIs){i=i.replace(/__URI__PRESERVER__/g,function(){return h.shift()})}if(b.preserve_HTML){i=i.replace(/__HTML__PRESERVER__/g,function(){return e.shift()})}return i};return a}));