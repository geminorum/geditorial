/*!
* Virastar - v0.12.0 - 2017-01-22
* https://github.com/juvee/virastar
* Licensed: MIT
*/
(function(a,c,b){if(typeof module!="undefined"){module.exports=b()}else{if(typeof define=="function"&&typeof define.amd=="object"){define(b)}else{if(typeof window!="undefined"){window[a]=b()}else{c[a]=b()}}}}("Virastar",this,function(){function a(c,b){if(!(this instanceof a)){return new a(c,b)}c=c||{};if(typeof c=="object"){this._init(c)}else{if(typeof c=="string"){this._init(b||{});return this.cleanup(c)}}return this}a.prototype._init=function(b){var d={normalize_eol:true,fix_dashes:true,fix_three_dots:true,fix_english_quotes_pairs:true,fix_english_quotes:true,fix_hamzeh:true,cleanup_rlm:true,cleanup_zwnj:true,fix_spacing_for_braces_and_quotes:true,fix_arabic_numbers:true,fix_english_numbers:true,fix_misc_non_persian_chars:true,fix_question_mark:true,skip_markdown_ordered_lists_numbers_conversion:true,fix_perfix_spacing:true,fix_suffix_spacing:true,aggresive:true,kashidas_as_parenthetic:true,cleanup_kashidas:true,cleanup_extra_marks:true,cleanup_spacing:true,cleanup_begin_and_end:true,preserve_HTML:true,preserve_URIs:true,preserve_brackets:true,preserve_braces:true,};for(var c in b){if(b.hasOwnProperty(c)){d[c]=b[c]}}this.opts=d};a.prototype.cleanup=function(j){var b=this.opts;if(b.preserve_HTML){var i=[];j=j.replace(/(<[^<>]+>)/g,function(o){i.push(o);return"__HTML__PRESERVER__"})}if(b.preserve_URIs){var h=new RegExp("([A-Za-z][A-Za-z0-9+\\-.]*):(?:(//)(?:((?:[A-Za-z0-9\\-._~!$&'()*+,;=:]|%[0-9A-Fa-f]{2})*)@)?((?:\\[(?:(?:(?:(?:[0-9A-Fa-f]{1,4}:){6}|::(?:[0-9A-Fa-f]{1,4}:){5}|(?:[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){4}|(?:(?:[0-9A-Fa-f]{1,4}:){0,1}[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){3}|(?:(?:[0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){2}|(?:(?:[0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}:|(?:(?:[0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})?::)(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}|(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))|(?:(?:[0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}|(?:(?:[0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})?::)|[Vv][0-9A-Fa-f]+\\.[A-Za-z0-9\\-._~!$&'()*+,;=:]+)\\]|(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|(?:[A-Za-z0-9\\-._~!$&'()*+,;=]|%[0-9A-Fa-f]{2})*))(?::([0-9]*))?((?:/(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})*)*)|/((?:(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})+(?:/(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})*)*)?)|((?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})+(?:/(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})*)*)|)(?:\\?((?:[A-Za-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9A-Fa-f]{2})*))?(?:\\#((?:[A-Za-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9A-Fa-f]{2})*))?","g");var e=[];j=j.replace(h,function(o){e.push(o);return"__URI__PRESERVER__"})}if(b.preserve_brackets){var m=[];j=j.replace(/(\[.*?\])/g,function(o){m.push(o);return"__BRACKETS__PRESERVER__"})}if(b.preserve_braces){var d=[];j=j.replace(/(\{.*?\})/g,function(o){d.push(o);return"__BRACES__PRESERVER__"})}if(b.normalize_eol){j=j.replace(/(\r?\n)|(\r\n?)/g,"\n")}if(b.fix_dashes){j=j.replace(/-{3}/g,"—");j=j.replace(/-{2}/g,"–")}if(b.fix_three_dots){j=j.replace(/\s*\.{3,}/g,"…")}if(b.fix_english_quotes_pairs){j=j.replace(/(“)(.+?)(”)/g,"«$2»")}if(b.fix_english_quotes){j=j.replace(/(["'`]+)(.+?)(\1)/g,"«$2»")}if(b.fix_hamzeh){j=j.replace(/(\S)(ه[\s\u200C]+[یي])(\s)/g,"$1\u0647\u0654$3")}if(b.cleanup_rlm){j=j.replace(/([^a-zA-Z\-_])(\u200F)/g,"$1\u200c")}if(b.cleanup_zwnj){j=j.replace(/\u200C{2,}/g,"\u200c");j=j.replace(/([۰-۹0-9إأةؤورزژاآدذ،؛,\:«»\\\/@#$٪×\*\(\)ـ\-=\|])\u200c/g,"$1");j=j.replace(/\u200c([\w])/g,"$1");j=j.replace(/([\w])\u200c/g,"$1");j=j.replace(/\u200c([\n\s\[\]\.،«»\:\(\)\؛\؟\?\;\$\!\@\-\=\+\\])/g,"$1");j=j.replace(/([\n\s\[\.،«»\:\(\)\؛\؟\?\;\$\!\@\-\=\+\\])\u200c/g,"$1");j=j.replace(/\s+\u200C|\u200C\s+/g," ")}var n=function(s,r,p){var t=r.split("");var o=p.split("");for(var q in t){s=s.replace(new RegExp(t[q],"g"),o[q])}return s};var l="۱۲۳۴۵۶۷۸۹۰";var f="١٢٣٤٥٦٧٨٩٠";var c="1234567890";var k=",;كي%";var g="،؛کی٪";if(b.fix_arabic_numbers){j=n(j,f,l)}j=j.replace(/(^|\s+)(\S+)(?=($|\s+))/g,function(o,p,q,r){if(q.match(/[a-zA-Z\-_]{2,}/g)){return o}if(q.match(/&#\d+;/g)){return o}if(b.skip_markdown_ordered_lists_numbers_conversion&&(o+r).match(/(?:(?:\r?\n)|(?:\r\n?)|(?:^|\n))\d+\.\s/)){return o}if(b.fix_english_numbers){o=n(o,c,l)}if(b.fix_misc_non_persian_chars){o=n(o,k,g)}if(b.fix_question_mark){o=o.replace(/(\?)/g,"\u061F")}return o});if(b.fix_perfix_spacing){j=j.replace(/((\s+|^)ن?می)\u0020/g,"$1\u200C")}if(b.fix_suffix_spacing){j=j.replace(/\u0020(تر(ی(ن)?)?|ها(ی)?\s+)/g,"\u200C$1")}if(b.aggresive){if(b.cleanup_extra_marks){j=j.replace(/(!){2,}/g,"$1");j=j.replace(/(\u061F){2,}/g,"$1")}if(b.kashidas_as_parenthetic){j=j.replace(/(\s)\u0640+/g,"$1–");j=j.replace(/\u0640+(\s)/g,"–$1")}if(b.cleanup_kashidas){j=j.replace(/(\S)\u0640+(\S)/g,"$1$2")}}if(b.fix_spacing_for_braces_and_quotes){j=j.replace(/[ \t\u200C]*(\()\s*([^)]+?)\s*?(\))[ \t\u200C]*/g," $1$2$3 ");j=j.replace(/[ \t\u200C]*(\[)\s*([^\]]+?)\s*?(\])[ \t\u200C]*/g," $1$2$3 ");j=j.replace(/[ \t\u200C]*(\{)\s*([^}]+?)\s*?(\})[ \t\u200C]*/g," $1$2$3 ");j=j.replace(/[ \t\u200C]*(“)\s*([^”]+?)\s*?(”)[ \t\u200C]*/g," $1$2$3 ");j=j.replace(/[ \t\u200C]*(«)\s*([^»]+?)\s*?(»)[ \t\u200C]*/g," $1$2$3 ");j=j.replace(/[ \t\u200C]*([:;,؛،.؟!]{1})[ \t\u200C]*/g,"$1 ");j=j.replace(/([۰-۹]+):\s+([۰-۹]+)/g,"$1:$2");j=j.replace(/(\u061F|!)\s(\u061F|!)/g,"$1$2");j=j.replace(/(\()\s*([^)]+?)\s*?(\))/g,"$1$2$3");j=j.replace(/(\[)\s*([^\]]+?)\s*?(\])/g,"$1$2$3");j=j.replace(/(\{)\s*([^}]+?)\s*?(\})/g,"$1$2$3");j=j.replace(/(“)\s*([^”]+?)\s*?(”)/g,"$1$2$3");j=j.replace(/(«)\s*([^»]+?)\s*?(»)/g,"$1$2$3")}if(b.cleanup_spacing){j=j.replace(/[ ]+/g," ");j=j.replace(/([\n]+)[ \t\u200C]*/g,"$1")}if(b.cleanup_begin_and_end){j=j.replace(/^[\s\u200c]+|[\s\u200c]+$/g,"")}if(b.preserve_braces){j=j.replace(/__BRACES__PRESERVER__/g,function(){return d.shift()})}if(b.preserve_brackets){j=j.replace(/__BRACKETS__PRESERVER__/g,function(){return m.shift()})}if(b.preserve_URIs){j=j.replace(/__URI__PRESERVER__/g,function(){return e.shift()})}if(b.preserve_HTML){j=j.replace(/__HTML__PRESERVER__/g,function(){return i.shift()})}return j};return a}));