/*!
* Virastar - v0.18.0 - 2019-05-11
* https://github.com/brothersincode/virastar
* Licensed: MIT
*/
!function(e,r,a){"undefined"!=typeof module?module.exports=a():"function"==typeof define&&"object"==typeof define.amd?define(a):"undefined"!=typeof window?window[e]=a():r[e]=a()}("Virastar",this,function(){function e(r,a){if(!(this instanceof e))return new e(r,a);if(r=r||{},"object"==typeof r)this.opts=this.parseOptions(r);else if("string"==typeof r)return this.opts=this.parseOptions(a||{}),this.cleanup(r);return this}return e.prototype={defaults:{normalize_eol:!0,decode_htmlentities:!0,fix_dashes:!0,fix_three_dots:!0,normalize_ellipsis:!0,fix_english_quotes_pairs:!0,fix_english_quotes:!0,fix_hamzeh:!0,cleanup_rlm:!0,cleanup_zwnj:!0,fix_spacing_for_braces_and_quotes:!0,fix_arabic_numbers:!0,fix_english_numbers:!0,fix_misc_non_persian_chars:!0,fix_punctuations:!0,fix_question_mark:!0,skip_markdown_ordered_lists_numbers_conversion:!0,fix_perfix_spacing:!0,fix_suffix_spacing:!0,aggresive:!0,kashidas_as_parenthetic:!0,cleanup_kashidas:!0,cleanup_extra_marks:!0,cleanup_spacing:!0,cleanup_line_breaks:!0,cleanup_begin_and_end:!0,preserve_HTML:!0,preserve_comments:!0,preserve_entities:!0,preserve_URIs:!0,preserve_nbsps:!0,preserve_brackets:!0,preserve_braces:!0},entities:{"sbquo;":"‚","lsquo;":"‘","lsquor;":"‚","ldquo;":"“","ldquor;":"„","rdquo;":"”","rdquor;":"”","rsquo;":"’","rsquor;":"’","apos;":"'","QUOT;":'"',QUOT:'"',"quot;":'"',quot:'"',"zwj;":"‍","ZWNJ;":"‌","zwnj;":"‌","shy;":"­"},numbersPersian:"۱۲۳۴۵۶۷۸۹۰",numbersArabic:"١٢٣٤٥٦٧٨٩٠",numbersEnglish:"1234567890",parseOptions:function(e){var r=this.defaults;for(var a in r)e.hasOwnProperty(a)&&(r[a]=e[a]);return r},charBatchReplace:function(e,r,a){var s=r.split(""),n=a.split("");for(var _ in s)e=e.replace(new RegExp(s[_],"g"),n[_]);return e},cleanup:function(e,r){if("string"!=typeof e)throw new TypeError("Expected a String");var a=this,s=r?a.parseOptions(r):a.opts;if(s.preserve_HTML){var n=[];e=e.replace(/<\/?[a-z][^>]*?>/gi,function(e){return n.push(e),"__HTML__PRESERVER__"})}if(s.preserve_comments){var _=[];e=e.replace(/<!--[\s\S]*?-->/g,function(e){return _.push(e),"__COMMENT__PRESERVER__"})}if(s.preserve_URIs){var i=[],t=new RegExp("([A-Za-z][A-Za-z0-9+\\-.]*):(?:(//)(?:((?:[A-Za-z0-9\\-._~!$&'()*+,;=:]|%[0-9A-Fa-f]{2})*)@)?((?:\\[(?:(?:(?:(?:[0-9A-Fa-f]{1,4}:){6}|::(?:[0-9A-Fa-f]{1,4}:){5}|(?:[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){4}|(?:(?:[0-9A-Fa-f]{1,4}:){0,1}[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){3}|(?:(?:[0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){2}|(?:(?:[0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}:|(?:(?:[0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})?::)(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}|(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))|(?:(?:[0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}|(?:(?:[0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})?::)|[Vv][0-9A-Fa-f]+\\.[A-Za-z0-9\\-._~!$&'()*+,;=:]+)\\]|(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|(?:[A-Za-z0-9\\-._~!$&'()*+,;=]|%[0-9A-Fa-f]{2})*))(?::([0-9]*))?((?:/(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})*)*)|/((?:(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})+(?:/(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})*)*)?)|((?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})+(?:/(?:[A-Za-z0-9\\-._~!$&'()*+,;=:@]|%[0-9A-Fa-f]{2})*)*)|)(?:\\?((?:[A-Za-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9A-Fa-f]{2})*))?(?:\\#((?:[A-Za-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9A-Fa-f]{2})*))?","g");e=e.replace(t,function(e){return i.push(e),"__URI__PRESERVER__"})}if(s.preserve_brackets){var u=[];e=e.replace(/(\[.*?\])/g,function(e){return u.push(e),"__BRACKETS__PRESERVER__"})}if(s.preserve_braces){var p=[];e=e.replace(/(\{.*?\})/g,function(e){return p.push(e),"__BRACES__PRESERVER__"})}if(s.preserve_nbsps){var c=[];e=e.replace(/&nbsp;|&#160;/gi,function(e){return c.push(e),"__NBSPS__PRESERVER__"})}if(s.decode_htmlentities&&(e=a.decodeHTMLEntities(e,s)),s.preserve_entities){var l=[];e=e.replace(/&(#?[^;\W]+;?)/g,function(e){return l.push(e),"__ENTITIES__PRESERVER__"})}return s.normalize_eol&&(e=e.replace(/(\r?\n)|(\r\n?)/g,"\n")),s.fix_dashes&&(e=e.replace(/-{3}/g,"—"),e=e.replace(/-{2}/g,"–")),s.fix_three_dots&&(e=a.fixThreeDots(e,s)),s.normalize_ellipsis&&(e=a.normalizeEllipsis(e,s)),s.fix_english_quotes_pairs&&(e=e.replace(/(“)(.+?)(”)/g,"«$2»")),s.fix_english_quotes&&(e=e.replace(/(["'`]+)(.+?)(\1)/g,"«$2»")),s.fix_hamzeh&&(e=e.replace(/(\S)(ه[\s\u200C]+[یي])(\s)/g,"$1هٔ$3"),e=e.replace(/(\S)(ه[\s\u200C]?\u0621)(\s)/g,"$1هٔ$3")),s.cleanup_rlm&&(e=e.replace(/([^a-zA-Z\-_])(\u200F)/g,"$1‌")),s.cleanup_zwnj&&(e=a.cleanupZWNJ(e,s)),s.fix_arabic_numbers&&(e=a.charBatchReplace(e,a.numbersArabic,a.numbersPersian)),e=e.replace(/(^|\s+)([[({"'“«]?)(\S+)([\])}"'”»]?)(?=($|\s+))/g,function(e,r,n,_,i,t){return _.match(/[a-zA-Z\-_]{2,}/g)?e:_.match(/%(?:\d+\$)?[+-]?(?:[ 0]|'.{1})?-?\d*(?:\.\d+)?[bcdeEufFgGosxX]/g)?e:_.match(/&#\d+;/g)?e:s.skip_markdown_ordered_lists_numbers_conversion&&(e+i+t).match(/(?:(?:\r?\n)|(?:\r\n?)|(?:^|\n))\d+\.\s/)?e:(s.fix_english_numbers&&(e=a.charBatchReplace(e,a.numbersEnglish,a.numbersPersian)),s.fix_punctuations&&(e=a.charBatchReplace(e,"%,;","٪،؛")),s.fix_misc_non_persian_chars&&(e=e.replace(/ك/g,"ک").replace(/ي/g,"ی").replace(/ى/g,"ی").replace(/ۍ/g,"ی").replace(/ې/g,"ی").replace(/ہ/g,"ه").replace(/[ەھ]/g,"ه")),s.fix_question_mark&&(e=e.replace(/(\?)/g,"؟")),e)}),s.fix_perfix_spacing&&(e=e.replace(/((\s|^)ن?می)\u0020/g,"$1‌"),e=e.replace(/((\s|^)بی)\u0020/g,"$1‌")),s.fix_suffix_spacing&&(e=e.replace(/\u0020((ام|ات|اش|ای|اید|ایم|اند)\s)/g,"‌$1"),e=e.replace(/\u0020(ها(ی)?\s)/g,"‌$1"),e=e.replace(/\u0020(تر((ی)|(ین))?\s)/g,"‌$1"),e=e.replace(/\u0020((هایی|هایم|هایت|هایش|هایمان|هایتان|هایشان)\s)/g,"‌$1")),s.aggresive&&(s.cleanup_extra_marks&&(e=e.replace(/(!){2,}/g,"$1"),e=e.replace(/(\u061F){2,}/g,"$1")),s.kashidas_as_parenthetic&&(e=e.replace(/(\s)\u0640+/g,"$1–"),e=e.replace(/\u0640+(\s)/g,"–$1")),s.cleanup_kashidas&&(e=e.replace(/(\S)\u0640+(\S)/g,"$1$2"),e=e.replace(/(\S)\u0640+(\S)/g,"$1$2"))),s.fix_spacing_for_braces_and_quotes&&(e=e.replace(/[ \t\u200C]*(\()\s*([^)]+?)\s*?(\))[ \t\u200C]*/g," $1$2$3 "),e=e.replace(/[ \t\u200C]*(\[)\s*([^\]]+?)\s*?(\])[ \t\u200C]*/g," $1$2$3 "),e=e.replace(/[ \t\u200C]*(\{)\s*([^}]+?)\s*?(\})[ \t\u200C]*/g," $1$2$3 "),e=e.replace(/[ \t\u200C]*(“)\s*([^”]+?)\s*?(”)[ \t\u200C]*/g," $1$2$3 "),e=e.replace(/[ \t\u200C]*(«)\s*([^»]+?)\s*?(»)[ \t\u200C]*/g," $1$2$3 "),e=e.replace(/[ \t\u200C]*([:;,؛،.؟!]{1})[ \t\u200C]*/g,"$1 "),e=e.replace(/([0-9۰-۹]+):\s+([0-9۰-۹]+)/g,"$1:$2"),e=e.replace(/([0-9۰-۹]+). ([0-9۰-۹]+)/g,"$1.$2"),e=e.replace(/(\u061F|!)\s(\u061F|!)/g,"$1$2"),e=e.replace(/(\()\s*([^)]+?)\s*?(\))/g,"$1$2$3"),e=e.replace(/(\[)\s*([^\]]+?)\s*?(\])/g,"$1$2$3"),e=e.replace(/(\{)\s*([^}]+?)\s*?(\})/g,"$1$2$3"),e=e.replace(/(“)\s*([^”]+?)\s*?(”)/g,"$1$2$3"),e=e.replace(/(«)\s*([^»]+?)\s*?(»)/g,"$1$2$3")),s.cleanup_spacing&&(e=e.replace(/[ ]+/g," "),e=e.replace(/(.)\u0020+([\u064e\u0650\u064f\u064b\u064d\u064C\u0651\u06C0])/g,"$1$2"),e=e.replace(/([\n]+)[ \t\u200C]*/g,"$1")),s.cleanup_line_breaks&&(e=e.replace(/(\n{2,})/g,"\n\n")),s.cleanup_begin_and_end&&(e=e.replace(/^[\s\u200c\u200e\u200f]+|[\s\u200c\u200e\u200f]+$/g,"")),s.preserve_entities&&(e=e.replace(/__ENTITIES__PRESERVER__/g,function(){return l.shift()})),s.preserve_nbsps&&(e=e.replace(/__NBSPS__PRESERVER__/g,function(){return c.shift()})),s.preserve_braces&&(e=e.replace(/__BRACES__PRESERVER__/g,function(){return p.shift()})),s.preserve_brackets&&(e=e.replace(/__BRACKETS__PRESERVER__/g,function(){return u.shift()})),s.preserve_URIs&&(e=e.replace(/__URI__PRESERVER__/g,function(){return i.shift()})),s.preserve_comments&&(e=e.replace(/__COMMENT__PRESERVER__/g,function(){return _.shift()})),s.preserve_HTML&&(e=e.replace(/__HTML__PRESERVER__/g,function(){return n.shift()})),e},cleanupZWNJ:function(e,r){return e=e.replace(/\u00ad/g,"‌"),e=e.replace(/\u200C{2,}/g,"‌"),e=e.replace(/([۰-۹0-9إأةؤورزژاآدذ،؛,:«»\\\/@#$٪×*()ـ\-=|])\u200c/g,"$1"),e=e.replace(/\u200c([\u064e\u0650\u064f\u064b\u064d\u064C\u0651\u06C0])/g,"$1"),e=e.replace(/\u200c([\w])/g,"$1"),e=e.replace(/([\w])\u200c/g,"$1"),e=e.replace(/\u200c([\n\s[].،«»:()؛؟?;$!@-=+\\])/g,"$1"),e=e.replace(/([\n\s[.،«»:()؛؟?;$!@\-=+\\])\u200c/g,"$1"),e=e.replace(/\s+\u200C|\u200C\s+/g," ")},decodeHTMLEntities:function(e,r){var a=this;return e.replace(/&(#?[^;\W]+;?)/g,function(e,r){var s;if(s=/^#(\d+);?$/.exec(r))return String.fromCharCode(parseInt(s[1],10));if(s=/^#[Xx]([A-Fa-f0-9]+);?/.exec(r))return String.fromCharCode(parseInt(s[1],16));var n=/;$/.test(r),_=n?r.replace(/;$/,""):r,i=a.entities[_]||n&&a.entities[r];return"number"==typeof i?String.fromCharCode(i):"string"==typeof i?i:"&"+r})},fixThreeDots:function(e,r){return e.replace(/\s*\.{3,}/g,"…")},normalizeEllipsis:function(e,r){return e.replace(/(…){2,}/g,"…")},flipPunctuations:function(e,r){var a=["-"],s=["!",".","،","…",'"'],n=[],_=[];e=this.fixThreeDots(e,r);for(var i=0;i<s.length;i++){var t=s[i],u=new RegExp("^\\"+t,"i");u.test(e)&&(e=e.replace(u,"").trim(),_.push(t))}for(var p=0;p<a.length;p++){var c=a[p],l=new RegExp("\\"+c+"$","i");l.test(e)&&(e=e.replace(l,"").trim(),n.push(c))}for(var f=0;f<n.length;f++)e=n[f]+" "+e;for(var o=0;o<_.length;o++)e+=_[o];return e=this.normalizeEllipsis(e,r)},swapQuotes:function(e,r){return e=e.replace(/(»)(.+?)(«)/g,"«$2»"),e=e.replace(/(”)(.+?)(“)/g,"“$2”")}},e});
